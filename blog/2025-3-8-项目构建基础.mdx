---
slug: npm åŒ…æ„å»ºåŸºç¡€
title: npm åŒ…åŸºç¡€æ„å»º
tags: [npm åŒ…]
keywords: [npm, package, åŸºç¡€]
description: å¼€å§‹æ„å»º npm åŒ…å‰éœ€è¦è€ƒè™‘çš„
---

# åŸºç¡€å¿…è¦çš„é…ç½®

## åˆå§‹åŒ– package.json

### æ‰§è¡Œåˆå§‹åŒ–

```bash
npm init -y
```

{/* truncate */}

### æ‰‹åŠ¨é…ç½®

æˆ–è€…æ‰‹åŠ¨é…ç½®ç›¸å…³ä¿¡æ¯ï¼ˆåŒ…å«æœªæåŠçš„åŠŸèƒ½ï¼‰ï¼š

```json
{
  "name": "a-type-of-js",
  "type": "module",
  "version": "1.0.0",
  "main": "dist/index.js",
  "module": "dist/index.esm.js",
  "types": "dist/index.d.ts",
  "files": ["dist"],
  "author": {
    "name": "earthnut",
    "email": "earthnut.dev@outlook.com",
    "url": "https://earthunut.dev"
  },
  "description": "a type of js",
  "keywords": ["js", "type"],
  "license": "MIT",
  "homepage": "https://earthnut.dev/a-type-of-js",
  "bugs": {
    "url": "https://github.com/earthnutDev/a-type-of-js/issues",
    "email": "earthnut.dev@outlook.com"
  },
  "repository": {
    "type": "git",
    "url": "git+https://github.com/earthnutDev/a-type-of-js.git"
  },
  "publishConfig": {
    "access": "public",
    "registry": "https://registry.npmjs.org"
  },
  "devDependencies": {
    "rollup": "^2.67.0",
    "@rollup/plugin-babel": "^6.0.2",
    "@rollup/plugin-commonjs": "^21.0.5"
  },
  "scripts": {
    "build": "rollup -c rollup.config.js"
  }
}
```

## ä»£ç æ ¼å¼åŒ–å·¥å…·

### å®‰è£…ä¾èµ–

```bash
npm i --save-dev prettier
```

### é…ç½®æ–‡ä»¶ .prettierrc

```json
{
  "printWidth": 80,
  "tabWidth": 2,
  "useTabs": false,
  "semi": true,
  "singleQuote": true,
  "trailingComma": "es5",
  "bracketSpacing": true,
  "arrowParens": "avoid",
  "proseWrap": "preserve",
  "htmlWhitespaceSensitivity": "css",
  "endOfLine": "lf"
}
```

### é…ç½®æ–‡ä»¶ .prettierignore

```markdown
node_modules/
dist
```

### æ‰§è¡Œè„šæœ¬æ·»åŠ 

```json
{
  "scripts": {
    "format": "prettier --write ."
  }
}
```

## ä»£ç æ£€æŸ¥å·¥å…·

### å®‰è£…ä¾èµ–

```bash
# eslint
npm i --save-dev eslint eslint-config-prettier
# for typescript
npm install --save-dev @typescript-eslint/parser @typescript-eslint/eslint-plugin
```

### é…ç½®æ–‡ä»¶ .eslintrc

```json
{
  "env": {
    "browser": true,
    "es2021": true
  },
  "extends": [
    "eslint:recommended",
    "prettier/eslint-config-prettier"
  ],
  "parser": "@typescript-eslint/parser",
```

### æ·»åŠ  lint è„šæœ¬

```json
{
  "scripts": {
    "lint": "eslint . --fix"
  }
}
```

## æ„å»ºå·¥å…· git ğŸª

### å®‰è£…ä¾èµ–

```bash
npm i --save-dev husky lint-staged
```

### é…ç½®æ–‡ä»¶ package.json

```json
{
  "lint-staged": {
    "*.{js,ts}": ["prettier --write", "eslint --fix", "git add"]
  },
  "scripts": {
    "prepare": "husky install"
  }
}
```

### åˆå§‹åŒ– Husky

```bash
npm run prepare
npx husky add .husky/pre-commit "npx lint-staged"
```

## æµ‹è¯•æ¡†æ¶ ï¼ˆjest ä¸ºä¾‹ï¼‰

å¯å‚è€ƒ [jest](/æ—¥å¿—/jest%20çš„ä½¿ç”¨)

### å®‰è£…ä¾èµ–

```bash
# jest
npm i --save-dev jest
# for typescript
npm i --save-dev ts-jest @types/jest
```

### é…ç½®æ–‡ä»¶ jest.config.js

```js
module.exports = {
  testEnvironment: 'node',
  testMatch: ['**/__tests__/**/*.[jt]s?(x)', '**/?(*.)+(spec|test).[tj]s?(x)'],
  coverageDirectory: 'coverage',
};
```

### æ·»åŠ æµ‹è¯•è„šæœ¬

```json
{
  "scripts": {
    "test": "jest"
  }
}
```

## typescript æ”¯æŒ

### å®‰è£…ä¾èµ–

```bash
npm i --save-dev typescript @types/node
```

### é…ç½®æ–‡ä»¶ tsconfig.json

```json
{
  "compilerOptions": {
    "target": "esnext",
    "module": "esnext",
    "moduleResolution": "node",
    "lib": ["esnext", "dom"],
    "esModuleInterop": true,
    "skipLibCheck": true,
    "strict": true,
    "noEmit": true,
    "resolveJsonModule": true,
    "allowSyntheticDefaultImports": true,
    "forceConsistentCasingInFileNames": true,
    "noImplicitReturns": true,
    "noFallthroughCasesInSwitch": true,
    "noUnusedLocals": true,
    "noUnusedParameters": true,
    "noImplicitAny": true,
    "noImplicitThis": true,
    "noImplicitOverride": true,
    "sourceMap": false,
    "emitDeclarationOnly": true,
    "declaration": true,
    "outDir": "dist",
    "declarationDir": "dist/types"
  },
  "include": ["src/**/*.ts"],
  "exclude": ["node_modules", "dist", "**/*.test.ts"]
}
```

## æ–‡ä»¶æ¨¡ç‰ˆ

### .gitignore

```markdown
node_modules/
dist
.DS_Store
.idea/
```

### .npmignore

```markdown
node_modules/
dist
.DS_Store
.idea/
tsconfig.json
jest.config.js
```
