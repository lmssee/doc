---
title: ç®€å•çš„ node å‡½æ•°ï¼ˆa-node-toolsï¼‰ - npm
sidebar_label: ä¸€ç‚¹ node æ–¹æ³•
pagination_prev: a-command/index
hide_title: true
---

# ä¸€äº›ç®€å•çš„ Node æ–¹æ³•

<PackageInfo packageName="a-node-tools" />

ä¸€ç‚¹ç”¨äº node ç¯å¢ƒçš„æ–¹æ³•é›†ã€‚

## å®‰è£…

<InstallInfo name="a-node-tools" />

ä¸€ä¸ªçº¯å‡½æ•°çš„å·¥å…·ï¼ŒåŒ…å«äº†

## file æ¨¡å—

- `readFileToJson` è¯»å– `.json` æ–‡ä»¶å¹¶è¿”å› JSON æˆ–ç©ºå¯¹è±¡ `null`
- `readFileToJsonSync` åŒæ­¥è¯»å– `.json` æ–‡ä»¶å¹¶è¿”å› `JSON` æˆ–ç©ºå¯¹è±¡ `null`
- `fileExist` æ–‡ä»¶æ˜¯å¦å­˜åœ¨
- `dirEmpty` ç›®å½•æ˜¯å¦ä¸ºç©º
- `writeJsonFile` æŠŠ `json` æ•°æ®å†™å…¥ç©ºç™½æ–‡ä»¶

## runOtherCode æ¨¡å—

- `runOtherCode` è¿è¡Œå…¶ä»–ä»£ç 
- `RunOtherCodeParam` è¿è¡Œå…¶ä»–ä»£ç çš„å‚æ•°ç±»å‹å£°æ˜
- `waitingTips` ä¸€ä¸ªç”¨äºç­‰å¾…çš„ç®€å•ç»ˆç«¯æç¤º
- `waitingTipsPrefixStore` ç”¨äºè‡ªå®šä¹‰ `waitingTips` çš„ç­‰å¾…çš„å‰ç¼€ emoji

### `runOtherCode`

- ç®€å•æ‰§è¡Œå…¶ä»–çš„å‘½ä»¤,**_è¯·æ³¨æ„ï¼Œè¯·ä¸è¦å°†ç”¨æˆ·è¾“å…¥å½“ä½œ `code` å€¼ä¼ å…¥æ–¹æ³•ï¼Œæ‰§è¡Œæœ‰é£é™©ï¼Œä¸”è°ƒä¸”çæƒœ_**
- åœ¨ä½¿ç”¨æ—¶ï¼Œå¦‚æœéœ€è¦è¯»å…¥è¾“å…¥æ“ä½œï¼Œè¿™æ—¶å€™ç›´æ¥ä½¿ç”¨ `runOtherCode` æ˜¾å¾—æœ‰äº›ç¬¨æ‹™ï¼ˆå› ä¸ºåŸåˆ™ä¸Šæ²¡æœ‰è¯»å–çš„æ“ä½œï¼‰
- é»˜è®¤ `Ctrl` + `C` ã€ `Ctrl` + `D` æ˜¯ä¸ä¼šé€€å‡º `runOtherCode` ï¼Œä½†æ˜¯å¯åœ¨ `wait`

```ts
import { runOtherCode } from 'a-node-tools';

const result = await runOtherCode({
  code: 'ls',
  printLog: true,
});
```

## `npmPkg` æ¨¡å—

- `getPkgInfoResult` æ–¹æ³• `getNpmPkgInfo` çš„è¿”å›å€¼ç±»å‹
- `getNpmPkgInfo` è·å– npm åŒ…ä¿¡æ¯
- `testNpmPackageExist` æµ‹è¯•åŒ…æ˜¯å¦å¯ä¸‹è½½å­˜åœ¨

ç°å¯é€šè¿‡ç¬¬äºŒå‚æ•°æŒ‡å®š npm registry æº

å¯æ¥å—å‚æ•°

```ts
type npmRegistry = 'å®˜æ–¹' | 'æ·˜å®' | 'è…¾è®¯' | 'ä¸­ç§‘å¤§' | 'yarn';
```

å„æºçš„æµ‹è¯•æƒ…å†µ

![æµ‹è¯•æƒ…å†µ](/img/æµ‹è¯•æºæƒ…å†µ.png)

ç”±ä¸Šå›¾å¯è§ï¼Œä½¿ç”¨ `æ·˜å®` æºæ—¶ï¼Œå»¶è¿Ÿç›¸å¯¹è¾ƒä½ã€‚è€Œæœ‰äº›å›½å†…æºéƒ½æ²¡æœ‰ `npm` åŸæºï¼ˆä½†æ˜¯å„æºæœ‰å„æºçš„ç”¨é€”ï¼Œè­¬å¦‚ï¼Œå¦‚æœæ˜¯åœ¨è…¾è®¯äº‘æœåŠ¡å™¨éƒ¨ç½²çš„æœåŠ¡ï¼Œå½“ç„¶æ˜¯ä½¿ç”¨è…¾è®¯çš„ npm æºæ¯”è¾ƒå¿«å•¦ï¼Œä¸¾è¡£åå±±ï¼‰å»¶è¿Ÿä½ã€‚

## path æ¨¡å—

- `pathJoin` æ–‡ä»¶åœ°å€æ‹¼æ¥
- `pathBasename` ç»™å‡ºæ–‡ä»¶è·¯å¾„è·å–æ–‡ä»¶åï¼Œä¸å¸¦æ–‡ä»¶ç±»å‹åç¼€
- `initializeFile` åˆå§‹åŒ–è·¯å¾„ `__filename` å’Œ `__dirname` ï¼Œå› ä¸ºè¿™ä¸¤ä¸ªä»…èƒ½åœ¨ `cjs` æ–‡ä»¶ä¸‹ä½¿ç”¨ï¼Œä½¿ç”¨è¿™é‡Œåšäº†åˆå§‹åŒ–ï¼Œå…¼å®¹
- `getCallerFilename` è·å–è°ƒç”¨å‡½æ•°çš„æ–‡ä»¶è·¯å¾„
- `isWindows` å½“å‰æ˜¯å¦ä¸º windows ç¯å¢ƒï¼Œç”¨äºåœ¨ä½¿ç”¨ `path` æ—¶åˆ†éš”ç¬¦ä¸åŒäº§ç”Ÿçš„å·®å¼‚
- `getDirectoryBy` æ ¹æ®ç›®æ ‡çš„æ–‡ä»¶æˆ–æ–‡ä»¶åæ¥æ‰¾åˆ°å­˜åœ¨è¯¥ç›®æ ‡çš„çˆ¶çº§ç›®å½•

### cursor éƒ¨åˆ†

ä½ å¯ä»¥ä½¿ç”¨ cursor è¿›è¡Œå¯¹å…‰æ ‡ä½ç½®è¿›è¡Œæ“æ§ï¼š

|          æ–¹æ³•           |              ç¤ºæ„              |                       å‚æ•°                       |
| :---------------------: | :----------------------------: | :----------------------------------------------: |
|          `_p`           |      åœ¨ node ç¯å¢ƒä¸‹çš„æ‰“å°      | `r` æ‰“å°çš„æ–‡æœ¬; `lineFeed` æ˜¯å¦æ¢è¡Œï¼Œç¼ºçœä¸º true |
|      `cursorHide`       |            å…‰æ ‡éšè—            |                        --                        |
|      `cursorShow`       |            å…‰æ ‡å±•ç¤º            |                        --                        |
|  `cursorPositionSave`   |          å‚¨å­˜å…‰æ ‡ä½ç½®          |                        --                        |
| `cursorPositionRestore` |          æ¢å¤å…‰æ ‡ä½ç½®          |                        --                        |
|     `cursorMoveUp`      |            å…‰æ ‡ä¸Šç§»            |       `numberOfUpwardMoves` åç§»é‡ï¼Œç¼ºçœ 1       |
|    `cursorMoveDown`     |            å…‰æ ‡ä¸‹ç§»            |        `numberOfMovesDown` åç§»é‡ï¼Œç¼ºçœ 1        |
|    `cursorMoveLeft`     |            å…‰æ ‡å·¦ç§»            |       `numberOfLeftShifts` åç§»é‡ï¼Œç¼ºçœ 1        |
|    `cursorMoveRight`    |            å…‰æ ‡å³ç§»            |       `numberOfRightShifts` åç§»é‡ï¼Œç¼ºçœ 1       |
|   `cursorAfterClear`    |          å…‰æ ‡åå†…å®¹ğŸ§¹          |                        --                        |
| `cursorLineAfterClear`  | æ¸…ç†å…‰æ ‡æ‰€åœ¨è¡Œå…‰æ ‡ä½ç½®åçš„å†…å®¹ |                                                  |
| `cursorLineBeforeClear` | æ¸…ç†å…‰æ ‡æ‰€åœ¨è¡Œå…‰æ ‡ä½ç½®å‰çš„å†…å®¹ |                                                  |
|    `cursorLineClear`    |    æ¸…ç†å…‰æ ‡æ‰€åœ¨è¡Œçš„æ‰€æœ‰å†…å®¹    |                                                  |

## terminal éƒ¨åˆ†

- `terminalPageUp` ç»ˆç«¯æ•´é¡µå‘ä¸Šæ»šåŠ¨
- `terminalPageOn` ç»ˆç«¯æ•´é¡µä¸‹ç¿»
- `terminalScrollScreen` å…¨å±æ»šåŠ¨
- `terminalScrollBetween` è®¾å®šç»ˆç«¯å¯æ»šåŠ¨èŒƒå›´

### readInput éƒ¨åˆ†

ç­‰å¾…ç”¨æˆ·è¾“å…¥çš„ä¸€ä¸ªå‡½æ•°ã€‚å› ä¸ºè¦ç­‰å¾…ï¼Œæ‰€ä»¥æ˜¯å¼‚æ­¥çš„ï¼Œä½¿ç”¨çš„æ—¶å€™åº”å½“ä½¿ç”¨ `await`

ä¾‹ï¼š

```js
import { isTrue } from 'a-type-of-js';
import { readInput , _p} from "a-node-tools";

// ä¸å»ºè®®ä½¿ç”¨å¼‚æ­¥å‡½æ•°ï¼Œå› ä¸ºæˆ‘æƒ³ä¸åˆ°ä½¿ç”¨åœºæ™¯ï¼Œæ‰€ä»¥ç§»é™¤äº†ç›¸å…³çš„åˆ¤æ–­
const callBackFunction = (keyValue: string | undefined, key:any)
=> {
    /// è‡ªå®šä¹‰å½“é‡åˆ°æŸä¸€ä¸ªé’Ÿæ„çš„é”®åˆ™å¯ä»¥è¿”å›ï¼Œè¿™é‡Œåªæ˜¯ç¤ºä¾‹ï¼Œæ²¡æœ‰è¯´å¿…é¡»è¦ `enter` é”®æ‰å¯ä»¥
    if(key.name && key.name == 'return') {
        return true;
    }
    else {
      // å¦‚æœè¿”å›çš„æ˜¯é `true` åˆ™ä¸ä¼šè§¦å‘å¼‚æ­¥äº‹ä»¶çš„ resolve äº‹ä»¶
      return _p(`æ¢ä¸€ä¸ªé”®è¯•è¯•ï¼Œè¿™ä¸ªé”®ï¼ˆ${keyValue}ï¼‰ä¸å…è®¸é€€å‡º`);
    }
};

async function main() {
    const result = await readInput(callBackFunction)
    // ä» `v4` ç‰ˆæœ¬å¼€å§‹ï¼Œ`Ctrl` + `C` ä¸å†å¼ºåˆ¶é€€å‡ºï¼Œè€Œæ˜¯äº¤äºˆæ‚¨å¤„ç†

    if (isTrue(result.isSIGINT)) {
      _p('è€é€¼ç™»ä½ è¦å¹²ä¹ˆï¼Ÿä½ ä»¥ä¸ºæŒ‰ä¸€ä¸ª `Ctrl` + `C` å°±èƒ½é€€å‡ºå»äº†ï¼Ÿ');
      _p('try again å•Šï¼');
      _p('æœ‰æœ¬äº‹æ‹”ç”µçº¿å‘€ï¼');
     await  main();
    }
}

await main();
```

## å…¶ä»–éƒ¨åˆ†

### \_p

ä¸€ä¸ªç®€å•çš„ process.stdout.write çš„å°è£…ï¼Œç”¨äºåœ¨ node ç¯å¢ƒå‘ç»ˆç«¯è¾“å…¥å†…å®¹

```ts
import { _p } from 'a-node-tools';

_p('hello'); // hello

_p('hello', false); // hello ï¼ˆæ‰“å°å®Œä¸æ¢è¡Œï¼Œå…‰æ ‡ä¾æ—§åœ¨ o åé¢ï¼‰
```

### colorLine

ä¸€æ¡å½©è‰²çš„åˆ†å‰²çº¿ï¼š

```ts
import { colorLine } from 'a-node-tools';

colorLine(); // æ‰“å°ä¸€ä¸ªå½©è‰²åˆ†å‰²çº¿
colorLine('å°±æ˜¯ç©'); // æ‰“å°ä¸€ä¸ªå½©è‰²åˆ†å‰²çº¿ï¼Œä¸­é—´æ˜¯æ–‡æœ¬ï¼š â€œå°±æ˜¯ç©â€
colorLine('å°±æ˜¯ç©', true); // æ‰“å°ä¸€ä¸ªå½©è‰²åˆ†å‰²çº¿ï¼Œä¸­é—´æ˜¯å½©è‰²æ–‡æœ¬ï¼š â€œå°±æ˜¯ç©â€
colorLine('å°±æ˜¯ç©', '#f21'); // æ‰“å°ä¸€ä¸ªå½©è‰²åˆ†å‰²çº¿ï¼Œä¸­é—´æ˜¯çº¢è‰²æ–‡æœ¬ï¼š â€œå°±æ˜¯ç©â€
```

### typewrite

ä¸€ä¸ªç®€å•çš„æ‰“å­—æœºæ•ˆæœï¼Œç”¨äºåœ¨ç»ˆç«¯è¾“å…¥å†…å®¹

```ts
import { typewrite } from 'a-node-tolls';

await typewrite(
  'ä¼Ÿå¤§çš„ä¸­åäººæ°‘å…±å’Œå›½ä¸‡å²ï¼\nä¼Ÿå¤§çš„ä¸­å›½å…±äº§å…šä¸‡å²ï¼\nä¼Ÿå¤§çš„ä¸­å›½äººæ°‘è§£æ”¾å†›ä¸‡å²ï¼\nå…¨å›½å„æ—äººæ°‘å¤§å›¢ç»“ä¸‡å²ï¼\nä¼Ÿå¤§çš„ä¸­å›½äººæ°‘ä¸‡å²ï¼',
);
```

### detectPackageManager

æ£€æµ‹å‘½ä»¤å¯åŠ¨çš„åŒ…ç®¡ç†å™¨

```ts
import { detectPackageManager } from 'a-node-tools';

detectPackageManager(); // è¿”å›å€¼å¯èƒ½æ˜¯ï¼š 'npm'ã€'yarn'ã€'pnpm'
```

## ä½¿ç”¨æ—¥å¿—

åœ¨å¼•ç”¨è¯¥åŒ…çš„åŒ…å†…ä½¿ç”¨è¯¥åŒ…å†…çš„æ–¹æ³•æ—¶ï¼Œå¯ä»¥ä½¿ç”¨å¯åŠ¨å‚æ•° `a_node_tools_dev=xxx` æ¥å¯ç”¨éƒ¨åˆ†æ–¹æ³•çš„æ—¥å¿—ã€‚

`xxx` å¯ç”¨çš„å€¼ä¸ºï¼š

- `"all"`
- `"error"`
- `"warn"`
- `"info"`
- `"true"`
- `"false"`

åœ¨ä½¿ç”¨ `a_node_tools_dev` å‚æ•°å€¼ä¸ºä¸Šé¢çš„å€¼æ—¶ï¼Œå°†ä¼šè¦†ç›–åŸé…ç½®çš„å‚æ•°å€¼ï¼Œç”šè‡³æ˜¯åœ¨ä»£ç ä¸­é…ç½®å€¼ä¹Ÿå°†è¢«è¦†ç›–ã€‚

ä»£ç å†…ä¸‹é¢çš„å€¼é…ç½® `ANodeToolsDevLog.type` è¯¥å€¼å°†ä¼šåŸé…ç½®å€¼ï¼Œæ˜¯è¿è¡Œæ—¶é…ç½®
